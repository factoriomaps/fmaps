!function(t){var a,s=(a=t.documentMode,"onhashchange"in t&&(void 0===a||7<a));L.Hash=function(t,a){this.onHashChange=L.Util.bind(this.onHashChange,this),t&&this.init(t,a)},L.Hash.parseHash=function(t){0===t.indexOf("#")&&(t=t.substr(1));var a=t.split("/");if(4==a.length){var s=parseInt(a[0],10),n=parseFloat(a[1]),i=parseFloat(a[2]),e=a[3].split("-");return!(isNaN(s)||isNaN(n)||isNaN(i))&&{center:new L.LatLng(n,i),zoom:s,layers:e}}return!1},L.Hash.formatHash=function(t){var a=t.getCenter(),s=t.getZoom(),n=Math.max(0,Math.ceil(Math.log(s)/Math.LN2)),i=[],e=this.options;for(var h in e)e.hasOwnProperty(h)&&t.hasLayer(e[h])&&i.push(h);return"#"+[s,a.lat.toFixed(n),a.lng.toFixed(n),i.join("-")].join("/")},L.Hash.prototype={map:null,lastHash:null,parseHash:L.Hash.parseHash,formatHash:L.Hash.formatHash,init:function(t,a){this.map=t,L.Util.setOptions(this,a),this.lastHash=null,this.onHashChange(),this.isListening||this.startListening()},removeFrom:function(t){this.changeTimeout&&clearTimeout(this.changeTimeout),this.isListening&&this.stopListening(),this.map=null},onMapMove:function(){if(this.movingMap||!this.map._loaded)return!1;var t=this.formatHash(this.map);this.lastHash!=t&&(location.replace(t),this.lastHash=t)},movingMap:!1,update:function(){var t=location.hash;if(t!==this.lastHash){var a=this.parseHash(t);if(a){this.movingMap=!0,this.map.setView(a.center,a.zoom);var s=a.layers,n=this.options,i=this;this.map.eachLayer(function(t){i.map.removeLayer(t)}),s.forEach(function(t,a,s){i.map.addLayer(n[t])}),this.movingMap=!1}else this.onMapMove(this.map)}},changeDefer:100,changeTimeout:null,onHashChange:function(){if(!this.changeTimeout){var t=this;this.changeTimeout=setTimeout(function(){t.update(),t.changeTimeout=null},this.changeDefer)}},isListening:!1,hashChangeInterval:null,startListening:function(){this.map.on("moveend layeradd layerremove",this.onMapMove,this),s?L.DomEvent.addListener(t,"hashchange",this.onHashChange):(clearInterval(this.hashChangeInterval),this.hashChangeInterval=setInterval(this.onHashChange,50)),this.isListening=!0},stopListening:function(){this.map.off("moveend layeradd layerremove",this.onMapMove,this),s?L.DomEvent.removeListener(t,"hashchange",this.onHashChange):clearInterval(this.hashChangeInterval),this.isListening=!1},_keyByValue:function(t,a){for(var s in t)if(t.hasOwnProperty(s))return t[s]===a?s:null}},L.hash=function(t,a){return new L.Hash(t,a)},L.Map.prototype.addHash=function(){this._hash=L.hash(this,this.options)},L.Map.prototype.removeHash=function(){this._hash.removeFrom()}}(window);